<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Shiloh Members</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    const password = "Shiloh707";
    let endpoint = "YOUR_WEB_APP_URL"; // Replace this with the deployed Apps Script Web App URL

    async function checkPassword() {
      const entered = document.getElementById("password").value;
      if (entered === password) {
        document.getElementById("login-box").classList.add("hidden");
        document.getElementById("members-panel").classList.remove("hidden");
        loadMembers();
      } else {
        alert("Incorrect password!");
      }
    }

    async function loadMembers() {
      const res = await fetch(endpoint + "?action=view");
      const data = await res.json();
      const tbody = document.getElementById("member-body");
      tbody.innerHTML = "";
      data.forEach((row, index) => {
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td class="border px-2">${row["Member ID"]}</td>
          <td class="border px-2">${row["Full Name"]}</td>
          <td class="border px-2">${row["Team"]}</td>
          <td class="border px-2">${row["Phone Number"]}</td>
          <td class="border px-2">${row["Date Joined"]}</td>
          <td class="border px-2">${row["Notes"]}</td>
          <td class="border px-2">
            <button onclick='editMember(${index})' class="text-blue-600">Edit</button> |
            <button onclick='deleteMember(${row["Member ID"]})' class="text-red-600">Delete</button>
          </td>
        `;
        tbody.appendChild(tr);
      });
    }

    async function addMember() {
      const member = {
        name: document.getElementById("name").value,
        team: document.getElementById("team").value,
        phone: document.getElementById("phone").value,
        dateJoined: document.getElementById("dateJoined").value,
        notes: document.getElementById("notes").value,
      };

      const res = await fetch(endpoint, {
        method: "POST",
        body: JSON.stringify({ action: "add", member }),
      });
      const msg = await res.text();
      alert(msg);
      loadMembers();
    }

    async function deleteMember(id) {
      if (!confirm("Delete this member?")) return;
      const res = await fetch(endpoint, {
        method: "POST",
        body: JSON.stringify({ action: "delete", id }),
      });
      const msg = await res.text();
      alert(msg);
      loadMembers();
    }

    function editMember(index) {
      alert("Edit functionality coming soon!");
    }
  </script>
</head>
<body class="bg-gray-100 text-green-900 font-sans">

  <!-- Login -->
  <div id="login-box" class="flex justify-center items-center h-screen">
    <div class="bg-white p-6 rounded shadow-md text-center">
      <h2 class="text-xl font-bold mb-4">Members Access</h2>
      <input id="password" type="password" placeholder="Enter Password" class="border p-2 w-full mb-4" />
      <button onclick="checkPassword()" class="bg-green-700 text-white px-4 py-2 rounded">Login</button>
    </div>
  </div>

  <!-- Members Panel -->
  <div id="members-panel" class="hidden p-6">
    <h1 class="text-2xl font-bold text-center mb-4">Shiloh Members</h1>

    <!-- Add Member -->
    <div class="bg-white p-4 rounded shadow mb-6">
      <h2 class="font-bold mb-2">Add New Member</h2>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <input id="name" type="text" placeholder="Full Name" class="border p-2" />
        <input id="team" type="text" placeholder="Team" class="border p-2" />
        <input id="phone" type="text" placeholder="Phone Number" class="border p-2" />
        <input id="dateJoined" type="date" class="border p-2" />
        <input id="notes" type="text" placeholder="Notes" class="border p-2 col-span-2" />
      </div>
      <button onclick="addMember()" class="bg-green-700 text-white px-4 py-2 mt-4 rounded">Add Member</button>
    </div>

    <!-- View Members -->
    <div class="bg-white p-4 rounded shadow">
      <h2 class="font-bold mb-2">All Members</h2>
      <table class="w-full border text-sm">
        <thead>
          <tr class="bg-green-100">
            <th class="border px-2">ID</th>
            <th class="border px-2">Name</th>
            <th class="border px-2">Team</th>
            <th class="border px-2">Phone</th>
            <th class="border px-2">Joined</th>
            <th class="border px-2">Notes</th>
            <th class="border px-2">Action</th>
          </tr>
        </thead>
        <tbody id="member-body"></tbody>
      </table>
    </div>
  </div>

</body>
</html>
